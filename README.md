AceDrums
========


1. Introduction
---------------
### 1.1 Project Overview
AceDrums is an electronic drum platform that aims to provide a realistic drum experience at a low cost, with the added benefit of providing the user with live graphs of the data each drum outputs. These graphs are designed to guide the user to achieving more accurate triggering and an overall better drum experience.

### 1.2 Background
Unlike acoustic drums, electric drums do not make any sound on their own. Instead they contain pressure sensors, called piezoelectric transducers1 (Figure 1.1), that generate a voltage proportional
to the intensity with which a drummer hits the drum. This voltage gets sent to a drum module that processes it to produce MIDI2 and drum sample outputs.
The meat of AceDrums deals with the processing of analog signals to produce MIDI drum messages. Instead of producing its own drum samples, AceDrums is designed to integrate with existing software MIDI Synthesizers like GarageBand, EZDrummer, Addictive Drums, and Superior Drummer.

### 1.3 Construction
For cost and convenience reasons, the basic
construction of AceDrums is that of a modified acoustic drum set. Piezoelectric transducers are mounted in each of the acoustic drums and on each of the acoustic cymbals, thus achieving the same result as the ‘professional’ electric kits at a fraction of the cost.

2. Design
---------
### 2.1 Project Scope
While this project is a blend between mechanical, electrical, and software engineering, the primary scope is that of software. Consequently, the mechanical (building of the physical drums and sensor mounts) and the electrical (designing of the piezo conditioning circuits) have been outsourced to the Internet. In other words, not much innovation is happening on those fronts. The software side, however, includes an exhilarating journey through the world of interfacing between real life and the digital world.

### 2.2 Piezoelectric Transducer Conditioning
Piezoelectric transducers can produce upwards of 60 volts. Most development boards, like the Arduino, are designed to operate on 5 volts. Connecting a 60 volt signal to any of the pins on the Arduino are likely to damage the board. Consequently, it was important to condition the signals coming from the piezo sensors before attempting to do anything with them on the Arduino. Figure 2.1 shows the output voltage over time from an unconditioned piezo transducer.
The circuit in figure 2.2 is designed specifically to turn figure 2.1 into figure 2.3.

### 2.3 Drum Construction
As mentioned in section 1.3, the drums are built by converting acoustic drums into electronic drums. This is accomplished by mounting sensors inside the drums to pick up both head and rim strokes. Cymbals require more engineering because they are a single piece of metal and because they need to be dampened. Mounting and dampening techniques are a compilation of an entire online community of DIY drummers, plus a little of my own instinct.

### 2.4 Analog Signal Analysis
Piezo mounting is an important thing. Figure 2.4 shows two different piezo signal wave forms. The top wave form was generated by holding a piezo transducer in one hand and tapping it with a finger from the other hand. The bottom wave form was generated by taping the piezo transducer to a tabletop and then tapping on it. This second set of data is much closer to the desired signal output from the piezo conditioning circuit, but still contains undesired fluctuation, as is evident at the beginning of the first wave.

3. Requirements
---------------
### 3.1 Hardware
#### 3.1.1 Piezo Circuits
  * When a piezo transducer is not sensing any pressure, its associated circuit should indicate 0.0 volts. When a piezo transducer is sensing maximum pressure, it’s associated circuit should indicate 5.0 volts.
  * Each piezo circuit should produce no greater than 5.0 volts and no less than 0.0 volts.
  * Every signal from a piezo circuit should output it’s maximum voltage and then sharply, but gradually dissipate back to 0.0 volts. A waveform like that of figure 4 sufficiently fulfills this requirement.

#### 3.1.2 Physical Drums
  * Each snare or tom should have 1 piezoelectric transducer mounted in the center of the head and 1 mounted in the ‘center’ of the rim.
  * Each bass drum should have a single piezoelectric transducer mounted in the center of the head.
  * Each cymbal should have 1 piezoelectric transducer mounted on the underside of the bow, 1 choke switch mounted underneath the edge, and 1 choke switch mounted under the bell.
  * Each hi-hat should have 1 piezoelectric transducer mounted under the bow, 1 IR distance sensor mounted under the bell, and 1 choke switch mounted under the bell.

#### 3.1.3 Brain / Drum Module
  * The brain must accept a minimum of 2 analog inputs per snare/tom, 2 per hi-hat, 1 per bass drum, and 1 per cymbal.
  * The brain must accept a minimum of 2 digital inputs per cymbal and 1 per hi-hat.
  * The brain must send basic MIDI data over serial USB.

### 3.2 Software
#### 3.2.1 Desktop Application
##### 3.2.1.1 External Interface
  * Application must manage sensor adjustment values and communicate changes to the microcontroller.
##### 3.2.1.2 Serial to MIDI Conversion
  * Application must take MIDI data coming in from the microcontroller and transfer it to a virtual MIDI device so that MIDI Synthesizer software can do something with it.
##### 3.2.1.3 Tempo
  * Application must provide a way of setting the tempo for a given drum groove or playing session.
  * Ideally, the application will also automatically detect the tempo from a live drum groove.
##### 3.2.1.4 Ghost Notes
  * Application must use the current tempo to automate generation and sending of useful MIDI messages not explicitly created via a drum stroke.

#### 3.2.2 Microcontroller
##### 3.2.2.1 External Interface
  * Microcontroller must output MIDI messages via serial USB to desktop application.
##### 3.2.2.2 Analog Signal Processing
  * Microcontroller must reject false triggers.
  * Microcontroller must define an appropriate threshold below which piezo voltage signals will be ignored.
  * Microcontroller must generate exactly 1 MIDI message per drum stroke.
